import{SvelteComponent,append,attr,bubble,children,claim_element,claim_space,claim_text,destroy_each,detach,element,empty,init,insert,listen,noop,prevent_default,run_all,safe_not_equal,set_data,space,text}from"../../web_modules/svelte/internal/index.mjs";import{publish}from"./publish.js";import{postLocal}from"./post_local.js";import{env}from"../env.js";import{findFileReferences}from"./file_references.js";function get_each_context(e,t,n){const s=e.slice();return s[15]=t[n],s}function get_each_context_1(e,t,n){const s=e.slice();return s[18]=t[n],s[20]=n,s}function create_if_block_3(e){let n,c,g,a,p,h,l,s,o,d,u,i,m,f,v,r=e[0],t=[];for(let n=0;n<r.length;n+=1)t[n]=create_each_block(get_each_context(e,r,n));return{c(){n=element("div"),c=element("div"),g=space(),a=element("div"),p=text("Are you sure you want to permanently remove:"),h=space();for(let e=0;e<t.length;e+=1)t[e].c();l=space(),s=element("div"),o=element("button"),d=text("Yes"),u=space(),i=element("button"),m=text("Cancel"),this.h()},l(e){n=claim_element(e,"DIV",{class:!0});var f,v,b,j,r=children(n);c=claim_element(r,"DIV",{class:!0}),children(c).forEach(detach),g=claim_space(r),a=claim_element(r,"DIV",{class:!0}),v=children(a),p=claim_text(v,"Are you sure you want to permanently remove:"),v.forEach(detach),h=claim_space(r);for(let e=0;e<t.length;e+=1)t[e].l(r);l=claim_space(r),s=claim_element(r,"DIV",{class:!0}),f=children(s),o=claim_element(f,"BUTTON",{class:!0}),b=children(o),d=claim_text(b,"Yes"),b.forEach(detach),u=claim_space(f),i=claim_element(f,"BUTTON",{class:!0}),j=children(i),m=claim_text(j,"Cancel"),j.forEach(detach),f.forEach(detach),r.forEach(detach),this.h()},h(){attr(c,"class","carrot svelte-hyt701"),attr(a,"class","warning svelte-hyt701"),attr(o,"class","primary svelte-hyt701"),attr(i,"class","secondary svelte-hyt701"),attr(s,"class","confirm-actions svelte-hyt701"),attr(n,"class","confirm svelte-hyt701")},m(r,b){insert(r,n,b),append(n,c),append(n,g),append(n,a),append(a,p),append(n,h);for(let e=0;e<t.length;e+=1)t[e].m(n,null);append(n,l),append(n,s),append(s,o),append(o,d),append(s,u),append(s,i),append(i,m),f||(v=[listen(o,"click",prevent_default(e[6])),listen(i,"click",prevent_default(e[11]))],f=!0)},p(e,s){if(s&1){r=e[0];let o;for(o=0;o<r.length;o+=1){const i=get_each_context(e,r,o);t[o]?t[o].p(i,s):(t[o]=create_each_block(i),t[o].c(),t[o].m(n,l))}for(;o<t.length;o+=1)t[o].d(1);t.length=r.length}},d(e){e&&detach(n),destroy_each(t,e),f=!1,run_all(v)}}}function create_if_block_4(e){let n,a,i,s,o=findFileReferences(e[15].file),t=[];for(let n=0;n<o.length;n+=1)t[n]=create_each_block_1(get_each_context_1(e,o,n));return{c(){n=element("div"),a=text("This file is being used on:"),i=space();for(let e=0;e<t.length;e+=1)t[e].c();s=empty(),this.h()},l(e){n=claim_element(e,"DIV",{class:!0});var o=children(n);a=claim_text(o,"This file is being used on:"),o.forEach(detach),i=claim_space(e);for(let n=0;n<t.length;n+=1)t[n].l(e);s=empty(),this.h()},h(){attr(n,"class","file-reference svelte-hyt701")},m(e,o){insert(e,n,o),append(n,a),insert(e,i,o);for(let n=0;n<t.length;n+=1)t[n].m(e,o);insert(e,s,o)},p(e,n){if(n&1){o=findFileReferences(e[15].file);let i;for(i=0;i<o.length;i+=1){const a=get_each_context_1(e,o,i);t[i]?t[i].p(a,n):(t[i]=create_each_block_1(a),t[i].c(),t[i].m(s.parentNode,s))}for(;i<t.length;i+=1)t[i].d(1);t.length=o.length}},d(e){e&&detach(n),e&&detach(i),destroy_each(t,e),e&&detach(s)}}}function create_if_block_5(){let t;return{c(){t=text(", ")},l(e){t=claim_text(e,", ")},m(e,n){insert(e,t,n)},d(e){e&&detach(t)}}}function create_each_block_1(e){let n,o=e[18]+"",i,a,r=e[20]<findFileReferences(e[15].file).length-1,s,t=r&&create_if_block_5(e);return{c(){n=element("a"),i=text(o),t&&t.c(),s=empty(),this.h()},l(e){n=claim_element(e,"A",{href:!0});var a=children(n);i=claim_text(a,o),a.forEach(detach),t&&t.l(e),s=empty(),this.h()},h(){attr(n,"href",a=e[18])},m(e,o){insert(e,n,o),append(n,i),t&&t.m(e,o),insert(e,s,o)},p(e,c){c&1&&o!==(o=e[18]+"")&&set_data(i,o),c&1&&a!==(a=e[18])&&attr(n,"href",a),c&1&&(r=e[20]<findFileReferences(e[15].file).length-1),r?t||(t=create_if_block_5(e),t.c(),t.m(s.parentNode,s)):t&&(t.d(1),t=null)},d(e){e&&detach(n),t&&t.d(e),e&&detach(s)}}}function create_each_block(e){let n,s=e[15].file+"",o,i,a=findFileReferences(e[15].file).length>0,t=a&&create_if_block_4(e);return{c(){n=element("div"),o=text(s),i=space(),t&&t.c(),this.h()},l(e){n=claim_element(e,"DIV",{class:!0});var a=children(n);o=claim_text(a,s),i=claim_space(a),t&&t.l(a),a.forEach(detach),this.h()},h(){attr(n,"class","delete-filepath svelte-hyt701")},m(e,s){insert(e,n,s),append(n,o),append(n,i),t&&t.m(n,null)},p(e,i){i&1&&s!==(s=e[15].file+"")&&set_data(o,s),i&1&&(a=findFileReferences(e[15].file).length>0),a?t?t.p(e,i):(t=create_if_block_4(e),t.c(),t.m(n,null)):t&&(t.d(1),t=null)},d(e){e&&detach(n),t&&t.d()}}}function create_else_block(e){let t;return{c(){t=text(e[1])},l(n){t=claim_text(n,e[1])},m(e,n){insert(e,t,n)},p(e,n){n&2&&set_data(t,e[1])},d(e){e&&detach(t)}}}function create_if_block_2(){let t;return{c(){t=text("Changes committed")},l(e){t=claim_text(e,"Changes committed")},m(e,n){insert(e,t,n)},p:noop,d(e){e&&detach(t)}}}function create_if_block_1(){let t;return{c(){t=text("Error saving")},l(e){t=claim_text(e,"Error saving")},m(e,n){insert(e,t,n)},p:noop,d(e){e&&detach(t)}}}function create_if_block(){let t;return{c(){t=text("Sending...")},l(e){t=claim_text(e,"Sending...")},m(e,n){insert(e,t,n)},p:noop,d(e){e&&detach(t)}}}function create_fragment(e){let o,i,n,r,c,l,t=e[5]&&create_if_block_3(e);function d(e){return e[4]=="sending"?create_if_block:e[4]=="failed"?create_if_block_1:e[4]=="sent"?create_if_block_2:create_else_block}let a=d(e,-1),s=a(e);return{c(){o=element("div"),t&&t.c(),i=space(),n=element("button"),s.c(),this.h()},l(e){o=claim_element(e,"DIV",{class:!0});var r,a=children(o);t&&t.l(a),i=claim_space(a),n=claim_element(a,"BUTTON",{type:!0,class:!0}),r=children(n),s.l(r),r.forEach(detach),a.forEach(detach),this.h()},h(){attr(n,"type","submit"),n.disabled=e[4],attr(n,"class",r=""+(e[4]+" "+e[3]+" svelte-hyt701")),attr(o,"class","button svelte-hyt701")},m(a,r){insert(a,o,r),t&&t.m(o,null),append(o,i),append(o,n),s.m(n,null),c||(l=[listen(n,"click",prevent_default(e[12])),listen(n,"click",e[10])],c=!0)},p(e,[c]){e[5]?t?t.p(e,c):(t=create_if_block_3(e),t.c(),t.m(o,i)):t&&(t.d(1),t=null),a===(a=d(e,c))&&s?s.p(e,c):(s.d(1),s=a(e),s&&(s.c(),s.m(n,null))),c&16&&(n.disabled=e[4]),c&24&&r!==(r=""+(e[4]+" "+e[3]+" svelte-hyt701"))&&attr(n,"class",r)},i:noop,o:noop,d(e){e&&detach(o),t&&t.d(),s.d(),c=!1,run_all(l)}}}function instance(e,t,n){let{commitList:o}=t,{shadowContent:r}=t,{buttonText:h}=t,{action:s}=t,{encoding:a}=t,{afterSubmit:l}=t,{buttonStyle:u="primary"}=t;const f=env.local??!1;let i,c;const m=async()=>{n(5,c=!1),n(4,i="sending");try{f?await postLocal(o,r,s,a):await publish(o,r,s,a),n(4,i="sent"),l?.(),d()}catch(e){throw n(4,i="failed"),d(),e}},d=()=>{setTimeout(()=>{n(4,i=""),n(0,o=[])},900)};function p(t){bubble.call(this,e,t)}const g=()=>n(5,c=!1),v=()=>s==="delete"?n(5,c=!0):s?m():null;return e.$$set=e=>{"commitList"in e&&n(0,o=e.commitList),"shadowContent"in e&&n(7,r=e.shadowContent),"buttonText"in e&&n(1,h=e.buttonText),"action"in e&&n(2,s=e.action),"encoding"in e&&n(8,a=e.encoding),"afterSubmit"in e&&n(9,l=e.afterSubmit),"buttonStyle"in e&&n(3,u=e.buttonStyle)},[o,h,s,u,i,c,m,r,a,l,p,g,v]}class Component extends SvelteComponent{constructor(e){super(),init(this,e,instance,create_fragment,safe_not_equal,{commitList:0,shadowContent:7,buttonText:1,action:2,encoding:8,afterSubmit:9,buttonStyle:3})}}export default Component